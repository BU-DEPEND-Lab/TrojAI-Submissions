Bootstrap: docker
From: python:3.9-bullseye

%files
    ./depend /
    ./detector.py /
    ./entrypoint.py /
    ./utils /
    ./metaparameters.json /
    ./metaparameters_schema.json /
    ./learned_parameters /
    ./best_experience.p /
    ./best_non_repeating_cls.p /
   
%post
    pip install --upgrade pip
    pip install torch torchvision --index-url https://download.pytorch.org/whl/cpu
    pip install gym gymnasium minigrid torch_ac jsonschema jsonargparse jsonpickle scikit-learn==1.1.2 opencv-python gym_minigrid==1.0.2

    pip install jsonschema
    pip install jsonpickle
    pip install -e ./depend/
    chmod 755 /*.py
     
    touch output.txt
    chmod 777 output.txt
    chmod -R 755 /utils
    chmod 755 /*.json
    chmod -R 755 /learned_parameters

%runscript
    exec python3 /entrypoint.py "$@"
